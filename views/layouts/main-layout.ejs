<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />

    <!-- font  -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet" />

    <!-- ig -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />

    <link rel="icon" href="img/logo_hmj.png" type="image/x-icon" />
    <title><%= title %></title>
    <link rel="stylesheet" href="<%= css %>" />
    <link rel="stylesheet" href="css/nav.css" />
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <script src="https://unpkg.com/@phosphor-icons/web@2.1.1"></script>
  </head>
  <body>
    <%- include('nav') %> <%- body %>

    <!-- Optional JavaScript; choose one of the two! -->

    <script src="<%= js %>"></script>
    <script src="/js/script.js"></script>
    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

    <!-- video yt -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://www.youtube.com/iframe_api"></script>

    <!-- Animasi aos -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
    -->

    <script>
      const text = "Bersinergi dari hati, berdedikasi untuk TI.";
      let i = 0;
      let isDeleting = false;

      function typeEffect() {
        let displayText = document.getElementById("typing");

        if (!isDeleting && i < text.length) {
          displayText.innerHTML = text.substring(0, i + 1);
          i++;
          displayText.classList.remove("hide-cursor"); // Munculkan kursor saat mengetik
          setTimeout(typeEffect, 100); // Kecepatan mengetik
        } else if (isDeleting && i > 0) {
          displayText.innerHTML = text.substring(0, i - 1);
          i--;
          setTimeout(typeEffect, 50); // Kecepatan menghapus
        } else {
          isDeleting = !isDeleting; // Balik status (ketik -> hapus -> ketik lagi)
          if (isDeleting) {
            displayText.classList.add("hide-cursor"); // Hilangkan kursor saat menghapus habis
          }
          setTimeout(typeEffect, 1000); // Tunggu sebelum ganti mode
        }
      }

      typeEffect(); // Mulai animasi
    </script>
    <script>
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            // Ketika element masuk ke viewport
            if (entry.isIntersecting) {
              // Menambahkan class show untuk memulai animasi
              if (entry.target.classList.contains("animate-right")) {
                entry.target.classList.add("show");
              }
              if (entry.target.classList.contains("animate-bottom")) {
                entry.target.classList.add("show");
              }
            }
          });
        },
        {
          threshold: 0.2, // Animasi akan mulai ketika 20% element terlihat
        }
      );

      // Mengamati semua element yang akan dianimasikan
      document.querySelectorAll(".animate-right, .animate-bottom").forEach((el) => {
        observer.observe(el);
      });
    </script>

    <script>
      // Mengecek parameter URL untuk success
      const urlParams = new URLSearchParams(window.location.search);
      const success = urlParams.get("success");
      const error = urlParams.get("error");

      if (success === "true") {
        Swal.fire({
          title: "Berhasil!",
          text: "Pesan Anda telah terkirim",
          icon: "success",
          confirmButtonText: "OK",
          confirmButtonColor: "#28a745",
        });
      }

      if (error) {
        let errorMessage = "";
        switch (error) {
          case "invalid_email":
            errorMessage = "Format email tidak valid";
            break;
          case "missing_fields":
            errorMessage = "Semua field harus diisi";
            break;
          case "db_error":
            errorMessage = "Terjadi kesalahan saat menyimpan data";
            break;
          default:
            errorMessage = "Terjadi kesalahan";
        }

        Swal.fire({
          title: "Error!",
          text: errorMessage,
          icon: "error",
          confirmButtonText: "OK",
          confirmButtonColor: "#dc3545",
        });
      }
    </script>

    <script>
      // Script untuk menutup alert
      document.addEventListener("DOMContentLoaded", function () {
        const closeButtons = document.querySelectorAll(".btn-close");
        closeButtons.forEach((button) => {
          button.addEventListener("click", function () {
            const alert = this.closest(".alert");
            alert.style.opacity = "0";
            setTimeout(() => {
              alert.style.display = "none";
            }, 150);
          });
        });

        // Auto hide alert after 5 seconds
        const alerts = document.querySelectorAll(".alert");
        alerts.forEach((alert) => {
          setTimeout(() => {
            alert.style.opacity = "0";
            setTimeout(() => {
              alert.style.display = "none";
            }, 150);
          }, 5000);
        });
      });
    </script>
  </body>
</html>
